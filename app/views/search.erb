
<div class="inner-width">
  <%= erb :searching_input_partial %>
  <div class="solid-results-div">
    <div class="results-header">
      <h3 id="results-count">Znaleziono <%= results.length %>
      <% if results.length == 0 || results.length > 4 %>
        wyników !
      <% elsif results.length == 1 %>
        wynik !
      <% else %>
        wyniki !
      <% end %></h3>
      <% if !results.empty? %>
      <input onclick="loadFilters()" type="submit" class="filter-button" value="Filtruj" id="find-submit" name="filtruj">
    </div>
    <div class="filters" id="filters-div">
      <form class="filter-form" action="find" method="post">
        <div class="filter-sets">
          <fieldset>
            <legend><input class="radio-table-filter" type="checkbox" id="table-filter-checkbox" name="table-filter">Filtruj Elementy</legend>
            <div class="radio-table-filter">
              <input type="radio" id="resistors" name="element" value="resistors" <% if params[:element] == "resistors" %> checked <% end %> disabled>
              <label for="resistors">Rezystory</label>
            </div>
            <div class="radio-table-filter">
              <input type="radio" id="capacitors" name="element" value="capacitors" <% if params[:element] == "capacitors" %> checked <% end %> disabled>
              <label for="capacitors">Kondensatory</label>
            </div>
            <div class="radio-table-filter">
              <input type="radio" id="inductors" name="element" value="inductors" <% if params[:element] == "inductors" %> checked <% end %> disabled>
              <label for="inductors">Cewki</label>
            </div>
            <div class="radio-table-filter">
              <input type="radio" id="others" name="element" value="others" disabled>
              <label for="others">Inne</label>
            </div>
          </fieldset>
          <fieldset>
            <legend><input class="limiting-filters" type="checkbox" id="limit-filter-checkbox" name="value-filter">Wartość</legend>
            <p>Działają przedrostki SI <br> np. "10k"</p>
            <div class="limiting-filters">
              <input type="text" title="I accept SI preix :S" class="filterInput" id="valueMinInput" name="valuemin" <% unless params[:valuemin].nil? %> value="<%= params[:valuemin] %>" <% else %> placeholder="Od" disabled <% end %>>
              <input type="text" title="I accept SI prefix :S" class="filterInput" id="valueMaxInput" name="valuemax" <% unless params[:valuemax].nil? %> value="<%= params[:valuemax] %>" <% else %> placeholder="Do" disabled <% end %>>
            </div>
          </fieldset>
          <fieldset>
            <legend>Sortowanie</legend>
            <select class="sort-dropdown" id="dropdown-sort" name="sort">
              <option value="asc">Od najniższej</option>
              <option value="desc" <% if params[:sort] == "desc" %> selected <% end %>>Od najwyższej</option>
            </select>
          </fieldset>
        </div>
        <input type="hidden" name="input-value" value="<%= @inputVal %>" id="input-value-hidden">
        <div class="filter-buttons">
          <input type="button" class="clear-filters" id="clear-filters" value="wyczyść filtry">
          <input type="submit" class="filter-button" id="find-submit" value="zatwierdź">
        </div>
      </form>
    </div>
      <table class="result-tab">
        <tr>
          <th>Lp.</th>
          <th>ID</th>
          <th>Nazwa</th>
          <th>wartość</th>
          <th>Opis</th>
          <th>Ilość</th>
          <th>Lokalizacja</th>
        </tr>
        <% results.each_with_index do |result, idx| %>
          <tr>
            <td><%= idx + 1 %>.</td>
            <td><%= result[:localid] %></td>
            <td><%= result[:name] %></td>
            <td><%= result[:value].to_human_redable %>
            <% if result.key?(:maxvoltage) %>F
            <% elsif result.key?(:powerdissipation) %>&#8486;
            <% else %>H
            <% end %></td>
            <td>
            <% if result.key?(:maxvoltage) %>
              <%if result[:maxvoltage] == 0 %>
                <%= result[:description] %>
              <% else %>
                <%= result[:maxvoltage] %>V <%= result[:description] %>
              <% end %>
              <% elsif result.key?(:powerdissipation) %>
                <%= result[:powerdissipation] %>
              <% else %>
                <%= result[:description] %>
              <% end %></td>
            <td><%= result[:quantity] %></td>
            <td> &nbsp;</td>
          </tr>
        <% end %>
      </table>
    <% end %>
  </div>
</div>

<% unless params[:"value-filter"].nil? %>
  <script>
    loadFilters();
    <% unless params[:valuemin].nil? && params[:valuemax].nil? %>
      const limitBox = _('limit-filter-checkbox');
      limitBox.checked = true;
    <% end %>
  </script>
<% end %>

<% unless params[:element].nil? %>
  <script>
    loadFilters();
    const tableBox = _('table-filter-checkbox');
    tableBox.checked = true;
    document.querySelectorAll('.radio-table-filter input').forEach(item => {
      item.disabled = false;
    })
  </script>
<% end %>
